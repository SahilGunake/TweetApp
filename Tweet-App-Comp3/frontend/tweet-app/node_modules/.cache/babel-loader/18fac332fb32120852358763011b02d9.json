{"ast":null,"code":"import { makeAutoObservable, runInAction } from \"mobx\";\nimport agent from \"../api/agent\";\nimport { store } from \"./store\";\nexport default class ProfileStore {\n  constructor() {\n    this.profile = null;\n    this.loadingProfile = false;\n    this.uploading = false;\n    this.loading = false;\n\n    this.loadProfile = async username => {\n      this.loadingProfile = true;\n\n      try {\n        const response = await agent.UserRequest.search(username);\n        runInAction(() => {\n          this.profile = response.result[0];\n          this.loadingProfile = false;\n        });\n      } catch (error) {}\n    };\n\n    this.uploadPhoto = async file => {\n      this.uploading = true;\n\n      try {\n        var _store$userStore$user;\n\n        const response = await agent.UserRequest.uploadPhoto((_store$userStore$user = store.userStore.user) === null || _store$userStore$user === void 0 ? void 0 : _store$userStore$user.email, file);\n        console.log(response.data);\n        runInAction(() => {\n          if (response.data.isSuccess) {\n            console.log(this.profile);\n            var element = response.data.result.photos[response.data.result.photos.length - 1];\n            console.log(element);\n            this.profile.photos.push(element);\n            if (element.isMain) this.profile.image = element.url;\n            console.log(this.profile);\n            this.uploading = false;\n          }\n        });\n      } catch (error) {\n        console.log(error);\n        runInAction(() => {\n          this.uploading = false;\n        });\n      }\n    };\n\n    this.setMainPhoto = async photo => {\n      this.loading = true;\n\n      try {\n        var _store$userStore$user2;\n\n        await agent.UserRequest.setMainPhoto((_store$userStore$user2 = store.userStore.user) === null || _store$userStore$user2 === void 0 ? void 0 : _store$userStore$user2.email, photo.id);\n        store.userStore.setImage(photo.url);\n        runInAction(() => {\n          if (this.profile && this.profile.photos) {\n            this.profile.photos.find(p => p.isMain).isMain = false;\n            this.profile.photos.find(p => p.id === photo.id).isMain = true;\n            this.profile.image = photo.url;\n            this.loading = false;\n          }\n        });\n      } catch (error) {\n        runInAction(() => {\n          this.loading = false;\n        });\n        console.log(error);\n      }\n    };\n\n    this.deletePhoto = async photo => {\n      this.loading = true;\n\n      try {\n        var _store$userStore$user3;\n\n        await agent.UserRequest.deletePhoto((_store$userStore$user3 = store.userStore.user) === null || _store$userStore$user3 === void 0 ? void 0 : _store$userStore$user3.email, photo.id);\n        runInAction(() => {\n          if (this.profile) {\n            var _this$profile$photos;\n\n            this.profile.photos = (_this$profile$photos = this.profile.photos) === null || _this$profile$photos === void 0 ? void 0 : _this$profile$photos.filter(p => p.id !== photo.id);\n            this.loading = false;\n          }\n        });\n      } catch (error) {\n        runInAction(() => {\n          this.loading = false;\n        });\n        console.log(error);\n      }\n    };\n\n    makeAutoObservable(this);\n  }\n\n  get isCurrentUser() {\n    if (store.userStore.user && this.profile) {\n      return store.userStore.user.email === this.profile.email;\n    }\n\n    return false;\n  }\n\n}","map":{"version":3,"names":["makeAutoObservable","runInAction","agent","store","ProfileStore","constructor","profile","loadingProfile","uploading","loading","loadProfile","username","response","UserRequest","search","result","error","uploadPhoto","file","userStore","user","email","console","log","data","isSuccess","element","photos","length","push","isMain","image","url","setMainPhoto","photo","id","setImage","find","p","deletePhoto","filter","isCurrentUser"],"sources":["S:/Cognizant-Training/FSE1/Project-demo/Tweet-App-Comp3/Tweet-App-Comp3/frontend/tweet-app/src/app/stores/profileStore.ts"],"sourcesContent":["import { makeAutoObservable, runInAction } from \"mobx\";\r\nimport agent from \"../api/agent\";\r\nimport { Photo, User } from \"../models/User\";\r\nimport { store } from \"./store\";\r\n\r\nexport default class ProfileStore {\r\n\tprofile: User | null = null;\r\n\tloadingProfile = false;\r\n\tuploading = false;\r\n\tloading = false;\r\n\tconstructor() {\r\n\t\tmakeAutoObservable(this);\r\n\t}\r\n\r\n\tget isCurrentUser() {\r\n\t\tif (store.userStore.user && this.profile) {\r\n\t\t\treturn store.userStore.user.email === this.profile.email;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tloadProfile = async (username: string) => {\r\n\t\tthis.loadingProfile = true;\r\n\t\ttry {\r\n\t\t\tconst response = await agent.UserRequest.search(username);\r\n\t\t\trunInAction(() => {\r\n\t\t\t\tthis.profile = response.result[0];\r\n\t\t\t\tthis.loadingProfile = false;\r\n\t\t\t});\r\n\t\t} catch (error) {}\r\n\t};\r\n\r\n\tuploadPhoto = async (file: Blob) => {\r\n\t\tthis.uploading = true;\r\n\t\ttry {\r\n\t\t\tconst response = await agent.UserRequest.uploadPhoto(\r\n\t\t\t\tstore.userStore.user?.email!,\r\n\t\t\t\tfile\r\n\t\t\t);\r\n\t\t\tconsole.log(response.data);\r\n\r\n\t\t\trunInAction(() => {\r\n\t\t\t\tif (response.data.isSuccess) {\r\n\t\t\t\t\tconsole.log(this.profile);\r\n\t\t\t\t\tvar element =\r\n\t\t\t\t\t\tresponse.data.result.photos[response.data.result.photos.length - 1];\r\n\t\t\t\t\tconsole.log(element);\r\n\t\t\t\t\tthis.profile!.photos.push(element);\r\n\t\t\t\t\tif (element.isMain) this.profile!.image = element.url;\r\n\t\t\t\t\tconsole.log(this.profile);\r\n\t\t\t\t\tthis.uploading = false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(error);\r\n\t\t\trunInAction(() => {\r\n\t\t\t\tthis.uploading = false;\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tsetMainPhoto = async (photo: Photo) => {\r\n\t\tthis.loading = true;\r\n\t\ttry {\r\n\t\t\tawait agent.UserRequest.setMainPhoto(\r\n\t\t\t\tstore.userStore.user?.email!,\r\n\t\t\t\tphoto.id\r\n\t\t\t);\r\n\t\t\tstore.userStore.setImage(photo.url);\r\n\t\t\trunInAction(() => {\r\n\t\t\t\tif (this.profile && this.profile.photos) {\r\n\t\t\t\t\tthis.profile.photos.find((p) => p.isMain)!.isMain = false;\r\n\t\t\t\t\tthis.profile.photos.find((p) => p.id === photo.id)!.isMain = true;\r\n\t\t\t\t\tthis.profile.image = photo.url;\r\n\t\t\t\t\tthis.loading = false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (error) {\r\n\t\t\trunInAction(() => {\r\n\t\t\t\tthis.loading = false;\r\n\t\t\t});\r\n\t\t\tconsole.log(error);\r\n\t\t}\r\n\t};\r\n\r\n\tdeletePhoto = async (photo: Photo) => {\r\n\t\tthis.loading = true;\r\n\t\ttry {\r\n\t\t\tawait agent.UserRequest.deletePhoto(\r\n\t\t\t\tstore.userStore.user?.email!,\r\n\t\t\t\tphoto.id\r\n\t\t\t);\r\n\t\t\trunInAction(() => {\r\n\t\t\t\tif (this.profile) {\r\n\t\t\t\t\tthis.profile.photos = this.profile.photos?.filter(\r\n\t\t\t\t\t\t(p) => p.id !== photo.id\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.loading = false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (error) {\r\n\t\t\trunInAction(() => {\r\n\t\t\t\tthis.loading = false;\r\n\t\t\t});\r\n\t\t\tconsole.log(error);\r\n\t\t}\r\n\t};\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}